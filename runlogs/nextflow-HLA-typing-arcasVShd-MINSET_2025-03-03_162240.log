
 N E X T F L O W   ~  version 24.10.4

Launching `main.nf` [determined_euler] DSL2 - revision: 05887263ae

[STATUS] Found FASTQ files in /home/sufyazi/repos/CRMY-NeonDisco-nf/inputs/mybc-main-test/minset
[-        ] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT    -
[-        ] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD     -
[-        ] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM -
[-        ] process > TYPE_HLA_ALLELES_ARCASHLA                   -
[3T, [/home/sufyazi/repos/CRMY-NeonDisco-nf/inputs/mybc-main-test/minset/3T_r1.fq, /home/sufyazi/repos/CRMY-NeonDisco-nf/inputs/mybc-main-test/minset/3T_r2.fq]]
[4T, [/home/sufyazi/repos/CRMY-NeonDisco-nf/inputs/mybc-main-test/minset/4T_r1.fq.gz, /home/sufyazi/repos/CRMY-NeonDisco-nf/inputs/mybc-main-test/minset/4T_r2.fq.gz]]

executor >  local (4)
[08/c9fb10] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (1)    [  0%] 0 of 2
[-        ] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD         -
[83/74e017] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (1) [  0%] 0 of 2
[-        ] process > TYPE_HLA_ALLELES_ARCASHLA                       -
[3T, [/home/sufyazi/repos/CRMY-NeonDisco-nf/inputs/mybc-main-test/minset/3T_r1.fq, /home/sufyazi/repos/CRMY-NeonDisco-nf/inputs/mybc-main-test/minset/3T_r2.fq]]
[4T, [/home/sufyazi/repos/CRMY-NeonDisco-nf/inputs/mybc-main-test/minset/4T_r1.fq.gz, /home/sufyazi/repos/CRMY-NeonDisco-nf/inputs/mybc-main-test/minset/4T_r2.fq.gz]]

executor >  local (5)
[08/c9fb10] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (1)    [ 50%] 1 of 2
[a9/d01e2c] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (1)     [  0%] 0 of 1
[83/74e017] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (1) [  0%] 0 of 2
[-        ] process > TYPE_HLA_ALLELES_ARCASHLA                       -



executor >  local (6)
[68/d0b76e] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (2)    [100%] 2 of 2 ✔
[30/6bf710] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (2)     [  0%] 0 of 2
[83/74e017] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (1) [  0%] 0 of 2
[-        ] process > TYPE_HLA_ALLELES_ARCASHLA                       -



executor >  local (6)
[68/d0b76e] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (2)    [100%] 2 of 2 ✔
[30/6bf710] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (2)     [  0%] 0 of 2
[83/74e017] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (1) [  0%] 0 of 2
[-        ] process > TYPE_HLA_ALLELES_ARCASHLA                       -

executor >  local (6)
[68/d0b76e] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (2)    [100%] 2 of 2 ✔
[30/6bf710] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (2)     [  0%] 0 of 2
[83/74e017] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (1) [ 50%] 1 of 2
[-        ] process > TYPE_HLA_ALLELES_ARCASHLA                       [  0%] 0 of 1

executor >  local (7)
[68/d0b76e] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (2)    [100%] 2 of 2 ✔
[30/6bf710] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (2)     [  0%] 0 of 2
[83/74e017] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (1) [ 50%] 1 of 2
[49/0d5d5f] process > TYPE_HLA_ALLELES_ARCASHLA (1)                   [  0%] 0 of 1

executor >  local (8)
[68/d0b76e] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (2)    [100%] 2 of 2 ✔
[30/6bf710] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (2)     [  0%] 0 of 2
[2e/571e8a] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (2) [100%] 2 of 2 ✔
[b5/1a9390] process > TYPE_HLA_ALLELES_ARCASHLA (2)                   [  0%] 0 of 2
ERROR ~ Error executing process > 'TYPE_HLA_ALLELES_ARCASHLA (1)'

Caused by:
  Missing output file(s) `*.genotype.json` expected by process `TYPE_HLA_ALLELES_ARCASHLA (1)`


Command executed:

  # Initialize variables
  SAMPLE_ID=3T
  BAM=3T-STAR_1pass_Aligned.out.bam
  
  echo "Processing files: ${BAM} of sample ${SAMPLE_ID}"
  echo "Number of cores to use: 4"
  echo "Starting arcasHLA typing..."
  
  # Running arcasHLA
  if bash /home/app/scripts/arcasHLA-nf.sh "${SAMPLE_ID}" "${BAM}" "4"; then
      echo "arcasHLA typing finished successfully!"
  else
      echo "arcasHLA typing failed. Check logs. Exiting..."
      exit 1
  fi

Command exit status:
  0

Command output:
  Processing files: 3T-STAR_1pass_Aligned.out.bam of sample 3T
  Number of cores to use: 4
  Starting arcasHLA typing...
  Running HLA-HD for sample: 3T
  Input BAM file: 3T-STAR_1pass_Aligned.out.bam
  Number of cores to use: 4
  arcasHLA typing finished successfully!

Command error:
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file: 3T-STAR_1pass_Aligned.out.bam
  [log] Read type: paired-end
  --------------------------------------------------------------------------------
  [extract] Extracting reads from 3T-STAR_1pass_Aligned.out.bam
  [extract] indexing bam: 
  
  	samtools index 3T-STAR_1pass_Aligned.out.bam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -H -@4 3T-STAR_1pass_Aligned.out.bam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -@4 -f 2 3T-STAR_1pass_Aligned.out.bam chr6 >> /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Sorting bam: 
  
  	samtools sort -n -@4 /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam
  
  [extract] Converting bam to fastq: 
  
  	bedtools bamtofastq -i /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam -fq ./3T-STAR_1pass_Aligned.out.extracted.1.fq -fq2 ./3T-STAR_1pass_Aligned.out.extracted.2.fq
  
  --------------------------------------------------------------------------------
  
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:164: SyntaxWarning: invalid escape sequence '\='
    elif line.startswith('FT') and re.search('allele\="HLA-', line):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:173: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:186: SyntaxWarning: invalid escape sequence '\s'
    elif line.startswith('FT') and (re.search('\sUTR\s',line)):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:187: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file(s): 3T-STAR_1pass_Aligned.out.extracted.1.fq.gz
  		     3T-STAR_1pass_Aligned.out.extracted.2.fq.gz
  [log] Reference: 
  --------------------------------------------------------------------------------
  [alignment] Analyzing read length
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/align.py:80: UserWarning: genfromtxt: Empty input file: "/tmp/arcas_14290e28-ff32-43f0-81e1-da5947e453f4/3T-STAR_1pass_Aligned.reads.txt"
    read_lengths = np.genfromtxt(reads_file)
  [genotype] Error: FASTQ files are empty; check arcasHLA extract for issues.

Work dir:
  /home/sufyazi/repos/CRMY-NeonDisco-nf/work/49/0d5d5fd122c2226df9050f9eaa1b6a

Container:
  sufyazi/arcashla-crmy

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`

 -- Check '.nextflow.log' file for details

executor >  local (8)
[68/d0b76e] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (2)    [100%] 2 of 2 ✔
[30/6bf710] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (2)     [  0%] 0 of 2
[2e/571e8a] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (2) [100%] 2 of 2 ✔
[49/0d5d5f] process > TYPE_HLA_ALLELES_ARCASHLA (1)                   [ 50%] 1 of 2, failed: 1
Execution cancelled -- Finishing pending tasks before exit
ERROR ~ Error executing process > 'TYPE_HLA_ALLELES_ARCASHLA (1)'

Caused by:
  Missing output file(s) `*.genotype.json` expected by process `TYPE_HLA_ALLELES_ARCASHLA (1)`


Command executed:

  # Initialize variables
  SAMPLE_ID=3T
  BAM=3T-STAR_1pass_Aligned.out.bam
  
  echo "Processing files: ${BAM} of sample ${SAMPLE_ID}"
  echo "Number of cores to use: 4"
  echo "Starting arcasHLA typing..."
  
  # Running arcasHLA
  if bash /home/app/scripts/arcasHLA-nf.sh "${SAMPLE_ID}" "${BAM}" "4"; then
      echo "arcasHLA typing finished successfully!"
  else
      echo "arcasHLA typing failed. Check logs. Exiting..."
      exit 1
  fi

Command exit status:
  0

Command output:
  Processing files: 3T-STAR_1pass_Aligned.out.bam of sample 3T
  Number of cores to use: 4
  Starting arcasHLA typing...
  Running HLA-HD for sample: 3T
  Input BAM file: 3T-STAR_1pass_Aligned.out.bam
  Number of cores to use: 4
  arcasHLA typing finished successfully!

Command error:
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file: 3T-STAR_1pass_Aligned.out.bam
  [log] Read type: paired-end
  --------------------------------------------------------------------------------
  [extract] Extracting reads from 3T-STAR_1pass_Aligned.out.bam
  [extract] indexing bam: 
  
  	samtools index 3T-STAR_1pass_Aligned.out.bam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -H -@4 3T-STAR_1pass_Aligned.out.bam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -@4 -f 2 3T-STAR_1pass_Aligned.out.bam chr6 >> /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Sorting bam: 
  
  	samtools sort -n -@4 /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam
  
  [extract] Converting bam to fastq: 
  
  	bedtools bamtofastq -i /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam -fq ./3T-STAR_1pass_Aligned.out.extracted.1.fq -fq2 ./3T-STAR_1pass_Aligned.out.extracted.2.fq
  
  --------------------------------------------------------------------------------
  
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:164: SyntaxWarning: invalid escape sequence '\='
    elif line.startswith('FT') and re.search('allele\="HLA-', line):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:173: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:186: SyntaxWarning: invalid escape sequence '\s'
    elif line.startswith('FT') and (re.search('\sUTR\s',line)):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:187: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file(s): 3T-STAR_1pass_Aligned.out.extracted.1.fq.gz
  		     3T-STAR_1pass_Aligned.out.extracted.2.fq.gz
  [log] Reference: 
  --------------------------------------------------------------------------------
  [alignment] Analyzing read length
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/align.py:80: UserWarning: genfromtxt: Empty input file: "/tmp/arcas_14290e28-ff32-43f0-81e1-da5947e453f4/3T-STAR_1pass_Aligned.reads.txt"
    read_lengths = np.genfromtxt(reads_file)
  [genotype] Error: FASTQ files are empty; check arcasHLA extract for issues.

Work dir:
  /home/sufyazi/repos/CRMY-NeonDisco-nf/work/49/0d5d5fd122c2226df9050f9eaa1b6a

Container:
  sufyazi/arcashla-crmy

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`

 -- Check '.nextflow.log' file for details

executor >  local (8)
[68/d0b76e] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (2)    [100%] 2 of 2 ✔
[30/6bf710] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (2)     [  0%] 0 of 2
[2e/571e8a] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (2) [100%] 2 of 2 ✔
[b5/1a9390] process > TYPE_HLA_ALLELES_ARCASHLA (2)                   [100%] 2 of 2, failed: 2 ✘

ERROR ~ Error executing process > 'TYPE_HLA_ALLELES_ARCASHLA (1)'

Caused by:
  Missing output file(s) `*.genotype.json` expected by process `TYPE_HLA_ALLELES_ARCASHLA (1)`


Command executed:

  # Initialize variables
  SAMPLE_ID=3T
  BAM=3T-STAR_1pass_Aligned.out.bam
  
  echo "Processing files: ${BAM} of sample ${SAMPLE_ID}"
  echo "Number of cores to use: 4"
  echo "Starting arcasHLA typing..."
  
  # Running arcasHLA
  if bash /home/app/scripts/arcasHLA-nf.sh "${SAMPLE_ID}" "${BAM}" "4"; then
      echo "arcasHLA typing finished successfully!"
  else
      echo "arcasHLA typing failed. Check logs. Exiting..."
      exit 1
  fi

Command exit status:
  0

Command output:
  Processing files: 3T-STAR_1pass_Aligned.out.bam of sample 3T
  Number of cores to use: 4
  Starting arcasHLA typing...
  Running HLA-HD for sample: 3T
  Input BAM file: 3T-STAR_1pass_Aligned.out.bam
  Number of cores to use: 4
  arcasHLA typing finished successfully!

Command error:
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file: 3T-STAR_1pass_Aligned.out.bam
  [log] Read type: paired-end
  --------------------------------------------------------------------------------
  [extract] Extracting reads from 3T-STAR_1pass_Aligned.out.bam
  [extract] indexing bam: 
  
  	samtools index 3T-STAR_1pass_Aligned.out.bam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -H -@4 3T-STAR_1pass_Aligned.out.bam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -@4 -f 2 3T-STAR_1pass_Aligned.out.bam chr6 >> /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Sorting bam: 
  
  	samtools sort -n -@4 /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam
  
  [extract] Converting bam to fastq: 
  
  	bedtools bamtofastq -i /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam -fq ./3T-STAR_1pass_Aligned.out.extracted.1.fq -fq2 ./3T-STAR_1pass_Aligned.out.extracted.2.fq
  
  --------------------------------------------------------------------------------
  
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:164: SyntaxWarning: invalid escape sequence '\='
    elif line.startswith('FT') and re.search('allele\="HLA-', line):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:173: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:186: SyntaxWarning: invalid escape sequence '\s'
    elif line.startswith('FT') and (re.search('\sUTR\s',line)):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:187: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file(s): 3T-STAR_1pass_Aligned.out.extracted.1.fq.gz
  		     3T-STAR_1pass_Aligned.out.extracted.2.fq.gz
  [log] Reference: 
  --------------------------------------------------------------------------------
  [alignment] Analyzing read length
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/align.py:80: UserWarning: genfromtxt: Empty input file: "/tmp/arcas_14290e28-ff32-43f0-81e1-da5947e453f4/3T-STAR_1pass_Aligned.reads.txt"
    read_lengths = np.genfromtxt(reads_file)
  [genotype] Error: FASTQ files are empty; check arcasHLA extract for issues.

Work dir:
  /home/sufyazi/repos/CRMY-NeonDisco-nf/work/49/0d5d5fd122c2226df9050f9eaa1b6a

Container:
  sufyazi/arcashla-crmy

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`

 -- Check '.nextflow.log' file for details

executor >  local (8)
[68/d0b76e] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (2)    [100%] 2 of 2 ✔
[a9/d01e2c] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (1)     [ 50%] 1 of 2
[2e/571e8a] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (2) [100%] 2 of 2 ✔
[b5/1a9390] process > TYPE_HLA_ALLELES_ARCASHLA (2)                   [100%] 2 of 2, failed: 2 ✘
ERROR ~ Error executing process > 'TYPE_HLA_ALLELES_ARCASHLA (1)'

Caused by:
  Missing output file(s) `*.genotype.json` expected by process `TYPE_HLA_ALLELES_ARCASHLA (1)`


Command executed:

  # Initialize variables
  SAMPLE_ID=3T
  BAM=3T-STAR_1pass_Aligned.out.bam
  
  echo "Processing files: ${BAM} of sample ${SAMPLE_ID}"
  echo "Number of cores to use: 4"
  echo "Starting arcasHLA typing..."
  
  # Running arcasHLA
  if bash /home/app/scripts/arcasHLA-nf.sh "${SAMPLE_ID}" "${BAM}" "4"; then
      echo "arcasHLA typing finished successfully!"
  else
      echo "arcasHLA typing failed. Check logs. Exiting..."
      exit 1
  fi

Command exit status:
  0

Command output:
  Processing files: 3T-STAR_1pass_Aligned.out.bam of sample 3T
  Number of cores to use: 4
  Starting arcasHLA typing...
  Running HLA-HD for sample: 3T
  Input BAM file: 3T-STAR_1pass_Aligned.out.bam
  Number of cores to use: 4
  arcasHLA typing finished successfully!

Command error:
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file: 3T-STAR_1pass_Aligned.out.bam
  [log] Read type: paired-end
  --------------------------------------------------------------------------------
  [extract] Extracting reads from 3T-STAR_1pass_Aligned.out.bam
  [extract] indexing bam: 
  
  	samtools index 3T-STAR_1pass_Aligned.out.bam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -H -@4 3T-STAR_1pass_Aligned.out.bam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -@4 -f 2 3T-STAR_1pass_Aligned.out.bam chr6 >> /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Sorting bam: 
  
  	samtools sort -n -@4 /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam
  
  [extract] Converting bam to fastq: 
  
  	bedtools bamtofastq -i /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam -fq ./3T-STAR_1pass_Aligned.out.extracted.1.fq -fq2 ./3T-STAR_1pass_Aligned.out.extracted.2.fq
  
  --------------------------------------------------------------------------------
  
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:164: SyntaxWarning: invalid escape sequence '\='
    elif line.startswith('FT') and re.search('allele\="HLA-', line):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:173: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:186: SyntaxWarning: invalid escape sequence '\s'
    elif line.startswith('FT') and (re.search('\sUTR\s',line)):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:187: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file(s): 3T-STAR_1pass_Aligned.out.extracted.1.fq.gz
  		     3T-STAR_1pass_Aligned.out.extracted.2.fq.gz
  [log] Reference: 
  --------------------------------------------------------------------------------
  [alignment] Analyzing read length
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/align.py:80: UserWarning: genfromtxt: Empty input file: "/tmp/arcas_14290e28-ff32-43f0-81e1-da5947e453f4/3T-STAR_1pass_Aligned.reads.txt"
    read_lengths = np.genfromtxt(reads_file)
  [genotype] Error: FASTQ files are empty; check arcasHLA extract for issues.

Work dir:
  /home/sufyazi/repos/CRMY-NeonDisco-nf/work/49/0d5d5fd122c2226df9050f9eaa1b6a

Container:
  sufyazi/arcashla-crmy

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`

 -- Check '.nextflow.log' file for details


executor >  local (8)
[68/d0b76e] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (2)    [100%] 2 of 2 ✔
[30/6bf710] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (2)     [100%] 2 of 2 ✔
[2e/571e8a] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (2) [100%] 2 of 2 ✔
[b5/1a9390] process > TYPE_HLA_ALLELES_ARCASHLA (2)                   [100%] 2 of 2, failed: 2 ✘
Pipeline completed at: 2025-03-03T18:13:47.014350012+08:00
Execution status: failed
ERROR ~ Error executing process > 'TYPE_HLA_ALLELES_ARCASHLA (1)'

Caused by:
  Missing output file(s) `*.genotype.json` expected by process `TYPE_HLA_ALLELES_ARCASHLA (1)`


Command executed:

  # Initialize variables
  SAMPLE_ID=3T
  BAM=3T-STAR_1pass_Aligned.out.bam
  
  echo "Processing files: ${BAM} of sample ${SAMPLE_ID}"
  echo "Number of cores to use: 4"
  echo "Starting arcasHLA typing..."
  
  # Running arcasHLA
  if bash /home/app/scripts/arcasHLA-nf.sh "${SAMPLE_ID}" "${BAM}" "4"; then
      echo "arcasHLA typing finished successfully!"
  else
      echo "arcasHLA typing failed. Check logs. Exiting..."
      exit 1
  fi

Command exit status:
  0

Command output:
  Processing files: 3T-STAR_1pass_Aligned.out.bam of sample 3T
  Number of cores to use: 4
  Starting arcasHLA typing...
  Running HLA-HD for sample: 3T
  Input BAM file: 3T-STAR_1pass_Aligned.out.bam
  Number of cores to use: 4
  arcasHLA typing finished successfully!

Command error:
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file: 3T-STAR_1pass_Aligned.out.bam
  [log] Read type: paired-end
  --------------------------------------------------------------------------------
  [extract] Extracting reads from 3T-STAR_1pass_Aligned.out.bam
  [extract] indexing bam: 
  
  	samtools index 3T-STAR_1pass_Aligned.out.bam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -H -@4 3T-STAR_1pass_Aligned.out.bam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -@4 -f 2 3T-STAR_1pass_Aligned.out.bam chr6 >> /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Sorting bam: 
  
  	samtools sort -n -@4 /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam
  
  [extract] Converting bam to fastq: 
  
  	bedtools bamtofastq -i /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam -fq ./3T-STAR_1pass_Aligned.out.extracted.1.fq -fq2 ./3T-STAR_1pass_Aligned.out.extracted.2.fq
  
  --------------------------------------------------------------------------------
  
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:164: SyntaxWarning: invalid escape sequence '\='
    elif line.startswith('FT') and re.search('allele\="HLA-', line):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:173: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:186: SyntaxWarning: invalid escape sequence '\s'
    elif line.startswith('FT') and (re.search('\sUTR\s',line)):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:187: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file(s): 3T-STAR_1pass_Aligned.out.extracted.1.fq.gz
  		     3T-STAR_1pass_Aligned.out.extracted.2.fq.gz
  [log] Reference: 
  --------------------------------------------------------------------------------
  [alignment] Analyzing read length
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/align.py:80: UserWarning: genfromtxt: Empty input file: "/tmp/arcas_14290e28-ff32-43f0-81e1-da5947e453f4/3T-STAR_1pass_Aligned.reads.txt"
    read_lengths = np.genfromtxt(reads_file)
  [genotype] Error: FASTQ files are empty; check arcasHLA extract for issues.

Work dir:
  /home/sufyazi/repos/CRMY-NeonDisco-nf/work/49/0d5d5fd122c2226df9050f9eaa1b6a

Container:
  sufyazi/arcashla-crmy

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`

 -- Check '.nextflow.log' file for details

executor >  local (8)
[68/d0b76e] process > HLA_TYPING_HLAHD:FISH_HLA_READS_SAMPBOWT (2)    [100%] 2 of 2 ✔
[30/6bf710] process > HLA_TYPING_HLAHD:TYPE_HLA_ALLELES_HLAHD (2)     [100%] 2 of 2 ✔
[2e/571e8a] process > ALIGN_READS_1PASS:ALIGN_READS_1PASS_STARSAM (2) [100%] 2 of 2 ✔
[b5/1a9390] process > TYPE_HLA_ALLELES_ARCASHLA (2)                   [100%] 2 of 2, failed: 2 ✘
Pipeline completed at: 2025-03-03T18:13:47.014350012+08:00
Execution status: failed
ERROR ~ Error executing process > 'TYPE_HLA_ALLELES_ARCASHLA (1)'

Caused by:
  Missing output file(s) `*.genotype.json` expected by process `TYPE_HLA_ALLELES_ARCASHLA (1)`


Command executed:

  # Initialize variables
  SAMPLE_ID=3T
  BAM=3T-STAR_1pass_Aligned.out.bam
  
  echo "Processing files: ${BAM} of sample ${SAMPLE_ID}"
  echo "Number of cores to use: 4"
  echo "Starting arcasHLA typing..."
  
  # Running arcasHLA
  if bash /home/app/scripts/arcasHLA-nf.sh "${SAMPLE_ID}" "${BAM}" "4"; then
      echo "arcasHLA typing finished successfully!"
  else
      echo "arcasHLA typing failed. Check logs. Exiting..."
      exit 1
  fi

Command exit status:
  0

Command output:
  Processing files: 3T-STAR_1pass_Aligned.out.bam of sample 3T
  Number of cores to use: 4
  Starting arcasHLA typing...
  Running HLA-HD for sample: 3T
  Input BAM file: 3T-STAR_1pass_Aligned.out.bam
  Number of cores to use: 4
  arcasHLA typing finished successfully!

Command error:
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file: 3T-STAR_1pass_Aligned.out.bam
  [log] Read type: paired-end
  --------------------------------------------------------------------------------
  [extract] Extracting reads from 3T-STAR_1pass_Aligned.out.bam
  [extract] indexing bam: 
  
  	samtools index 3T-STAR_1pass_Aligned.out.bam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -H -@4 3T-STAR_1pass_Aligned.out.bam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Extracting chromosome 6: 
  
  	samtools view -@4 -f 2 3T-STAR_1pass_Aligned.out.bam chr6 >> /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam
  
  [extract] Sorting bam: 
  
  	samtools sort -n -@4 /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sam -o /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam
  
  [extract] Converting bam to fastq: 
  
  	bedtools bamtofastq -i /tmp/arcas_0338ad6f-f794-451c-9e5f-f1a6282254da/3T-STAR_1pass_Aligned.out.hla.sorted.bam -fq ./3T-STAR_1pass_Aligned.out.extracted.1.fq -fq2 ./3T-STAR_1pass_Aligned.out.extracted.2.fq
  
  --------------------------------------------------------------------------------
  
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:164: SyntaxWarning: invalid escape sequence '\='
    elif line.startswith('FT') and re.search('allele\="HLA-', line):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:173: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:186: SyntaxWarning: invalid escape sequence '\s'
    elif line.startswith('FT') and (re.search('\sUTR\s',line)):
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/reference.py:187: SyntaxWarning: invalid escape sequence '\s'
    info = re.split('\s+', line)
  
  --------------------------------------------------------------------------------
  [log] Date: 2025-03-03
  [log] Sample: 3T-STAR_1pass_Aligned
  [log] Input file(s): 3T-STAR_1pass_Aligned.out.extracted.1.fq.gz
  		     3T-STAR_1pass_Aligned.out.extracted.2.fq.gz
  [log] Reference: 
  --------------------------------------------------------------------------------
  [alignment] Analyzing read length
  /opt/conda/share/arcas-hla-0.6.0-2/scripts/align.py:80: UserWarning: genfromtxt: Empty input file: "/tmp/arcas_14290e28-ff32-43f0-81e1-da5947e453f4/3T-STAR_1pass_Aligned.reads.txt"
    read_lengths = np.genfromtxt(reads_file)
  [genotype] Error: FASTQ files are empty; check arcasHLA extract for issues.

Work dir:
  /home/sufyazi/repos/CRMY-NeonDisco-nf/work/49/0d5d5fd122c2226df9050f9eaa1b6a

Container:
  sufyazi/arcashla-crmy

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`

 -- Check '.nextflow.log' file for details

