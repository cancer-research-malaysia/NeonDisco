flowchart TB
    subgraph " "
    v4["Channel.fromPath"]
    v16["starIndex"]
    v24["starIndex"]
    v28["starIndex"]
    v30["arribaDB"]
    v32["fuscatDB"]
    v34["ctatDB"]
    v40["metaDataDir"]
    v46["ctatDB"]
    v67["metaDataDir"]
    end
    subgraph "TRIMMING_WF [TRIMMING_WF]"
    v15(["TRIM_READS_FASTP"])
    end
    subgraph "TWOPASS_ALIGNMENT_WF [TWOPASS_ALIGNMENT_WF]"
    v17(["ALIGN_READS_TWOPASS_STARSAM"])
    v18(["FIXMATES_MARKDUPES_SAMTOOLS"])
    end
    subgraph "HLA_TYPING_WF [HLA_TYPING_WF]"
    v19(["TYPE_HLA_ALLELES_ARCASHLA"])
    v20(["REFORMAT_HLA_TYPES_PYENV"])
    v23(["COLLATE_HLA_FILES_BASH"])
    v21(( ))
    v22(( ))
    end
    subgraph "AGGREGATE_FUSION_CALLING_WF [AGGREGATE_FUSION_CALLING_WF]"
    v25(["ALIGN_READS_STAR_GENERAL"])
    v26(["FILTER_ALIGNED_READS_EASYFUSE"])
    v27(["CONVERT_FILTREADS_BAM2FASTQ_EASYFUSE"])
    v29(["ALIGN_READS_STAR_ARRIBA"])
    v31(["CALL_FUSIONS_ARRIBA"])
    v33(["CALL_FUSIONS_FUSIONCATCHER"])
    v35(["CALL_FUSIONS_STARFUSION"])
    v38(["COLLATE_FUSIONS_PYENV"])
    v41(["FILTER_FUSIONS_PYENV"])
    v36(( ))
    end
    subgraph " "
    v39[" "]
    v51[" "]
    v58["cohortValidatedFusions"]
    v62[" "]
    v63["recurrentValidatedDir"]
    v64[" "]
    v69[" "]
    end
    subgraph "IN_SILICO_TRANSCRIPT_VALIDATION_WF [IN_SILICO_TRANSCRIPT_VALIDATION_WF]"
    v42(["TRANSLATE_IN_SILICO_AGFUSION"])
    v47(["VALIDATE_IN_SILICO_FUSIONINSPECTOR"])
    v43(( ))
    end
    subgraph "RECURRENT_FUSION_FILTERING_WF [RECURRENT_FUSION_FILTERING_WF]"
    v49(["CONCAT_NORMFILTERED_FUSION_FILES_PYENV"])
    v50(["GET_COHORT_RECURRENT_FUSIONS_PYENV"])
    end
    subgraph "NEOANTIGEN_PREDICTION_WF [NEOANTIGEN_PREDICTION_WF]"
    v55(["KEEP_VALIDATED_FUSIONS_PYENV"])
    subgraph "NEOANTIGEN_PREDICTION_WF:COLLECT_COHORTWIDE_FI_VALIDATED_FUSIONS [COLLECT_COHORTWIDE_FI_VALIDATED_FUSIONS]"
    v57(["COLLECT_COHORTWIDE_VALIDATED_FUSIONS_PYENV"])
    end
    v61(["FILTER_VALIDATED_FUSIONS_FOR_RECURRENT_PYENV"])
    subgraph "NEOANTIGEN_PREDICTION_WF:SAMPLE_LEVEL_HLA_NEOANTIGENS [SAMPLE_LEVEL_HLA_NEOANTIGENS]"
    v68(["PREDICT_NEOPEPTIDES_SAMPLE_LEVEL_HLAS_PVACFUSE"])
    end
    v52(( ))
    v56(( ))
    v59(( ))
    end
    v5(( ))
    v48(( ))
    v4 --> v5
    v5 --> v15
    v15 --> v17
    v15 --> v25
    v15 --> v43
    v16 --> v17
    v17 --> v18
    v18 --> v19
    v19 --> v20
    v20 --> v21
    v20 --> v22
    v21 --> v23
    v22 --> v23
    v23 --> v68
    v24 --> v25
    v25 --> v26
    v26 --> v27
    v27 --> v29
    v27 --> v33
    v27 --> v35
    v28 --> v29
    v29 --> v31
    v30 --> v31
    v31 --> v36
    v32 --> v33
    v33 --> v36
    v34 --> v35
    v35 --> v36
    v36 --> v38
    v38 --> v41
    v38 --> v39
    v40 --> v41
    v41 --> v42
    v41 --> v43
    v41 --> v48
    v41 --> v52
    v42 --> v43
    v42 --> v52
    v46 --> v47
    v43 --> v47
    v47 --> v52
    v48 --> v49
    v49 --> v50
    v50 --> v61
    v50 --> v51
    v52 --> v55
    v55 --> v68
    v55 --> v56
    v55 --> v59
    v56 --> v57
    v57 --> v58
    v59 --> v61
    v61 --> v64
    v61 --> v63
    v61 --> v62
    v67 --> v68
    v68 --> v69
